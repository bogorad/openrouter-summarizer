{"id":"ORS-0rc","title":"Memory leak from uncleaned event listeners in highlighter.js","description":"The highlighter.js module attaches event listeners to window and document in initializeHighlighter() but does not provide a cleanup function to remove them when the content script is unloaded or reloaded. Old event listeners hold references to DOM elements and prevent garbage collection.\n\n**Location:** highlighter.js:254-265 (initializeHighlighter)\n\n**Fix:** Implement addTrackedEventListener() helper that stores listeners in an array. Export cleanupHighlighter() function that removes all tracked listeners. Call cleanup on window unload event.","status":"open","priority":2,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:25.776969565+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:25.776969565+01:00","labels":["bug","medium","memory"]}
{"id":"ORS-39g","title":"Broad \u003call_urls\u003e host permission violates least privilege","description":"The manifest.json declares \u003call_urls\u003e in both host_permissions and content_scripts.matches, granting the extension access to read and modify content on every website. This is excessive for an extension that only needs access when the user explicitly activates it via Alt+Click. Combined with the XSS vulnerability, this creates a critical attack chain.\n\n**Location:** manifest.json:12-14 (host_permissions), manifest.json:21-23 (content_scripts.matches)\n\n**Fix:** Remove broad host_permissions and rely on activeTab permission with optional_host_permissions for user-granted access.","status":"open","priority":1,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:21:57.889438403+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:21:57.889438403+01:00","labels":["high","security"]}
{"id":"ORS-46z","title":"Remove unused numToWord object (dead code)","description":"The pageInteraction.js file defines a numToWord object at lines 37-44 that is never used anywhere in the codebase. This is dead code that should be removed.\n\n**Location:** pageInteraction.js:37-44\n\n**Fix:** Delete the unused numToWord const declaration.","status":"open","priority":3,"issue_type":"chore","owner":"bogorad@gmail","created_at":"2026-01-31T14:23:27.997197748+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:23:27.997197748+01:00","labels":["code-quality","dead-code","low"]}
{"id":"ORS-4ju","title":"Insecure Storage of API Tokens in chrome.storage.sync","description":"The extension stores OpenRouter API keys, NewsBlur tokens, and Joplin tokens in chrome.storage.sync without encryption. Chrome's sync storage synchronizes data across all devices signed into the same Google account via Google's servers. The keys are accessible to Google and vulnerable to: (1) Google account compromise, (2) Browser forensic analysis, (3) Malicious extensions with storage permissions.\n\n**Location:** options.js:1363-1450 (saveSettings), background.js:74-76 (API key retrieval)\n\n**Fix:** Use chrome.storage.local instead of sync for sensitive tokens. Implement AES-GCM encryption using Web Crypto API before storage.","status":"open","priority":1,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:21:49.016386881+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:21:49.016386881+01:00","labels":["high","security"]}
{"id":"ORS-50s","title":"Missing language detection response validation","description":"The detectLanguage() function in summaryHandler.js accepts the LLM's response as a 3-character ISO 639-2 code with minimal validation. Only checks length === 3, not character set (could contain special characters, numbers). No whitelist of valid language codes. Malformed response could cause injection or malformed prompts.\n\n**Location:** js/summaryHandler.js:64-79 (language code validation)\n\n**Fix:** Add regex validation /^[a-z]{3}$/ and whitelist of valid ISO 639-2 codes in constants.js (VALID_LANGUAGE_CODES Set).","status":"open","priority":2,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:40.157982252+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:40.157982252+01:00","labels":["bug","medium","validation"]}
{"id":"ORS-75m","title":"Remove LLM-addressed comment artifact in constants.js","description":"The constants.js file contains a comment block at lines 3-9 addressed to 'LLMs' that appears to be a prompt engineering artifact rather than documentation. This is confusing to human developers.\n\n**Location:** constants.js:3-9\n\n**Fix:** Remove the inappropriate comment and replace with standard JSDoc documentation for the constants file.","status":"open","priority":3,"issue_type":"chore","owner":"bogorad@gmail","created_at":"2026-01-31T14:23:08.191976302+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:23:08.191976302+01:00","labels":["code-quality","low"]}
{"id":"ORS-878","title":"Inconsistent message handler return patterns cause channel closure","description":"The handleMessage() function in pageInteraction.js has inconsistent return patterns. Some paths return true (async response), others return false or nothing. When chrome.runtime.onMessage.addListener returns false/undefined, Chrome immediately closes the message port. Later sendResponse() calls fail with 'disconnected port object' error.\n\n**Location:** pageInteraction.js:765-809\n\n**Fix:** Always return true from message handlers. Wrap all handling in async IIFE and always call sendResponse() in all code paths.","status":"open","priority":2,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:32.72143595+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:32.72143595+01:00","labels":["bug","medium"]}
{"id":"ORS-a85","title":"Inconsistent error handling patterns cause silent failures","description":"The codebase exhibits inconsistent error handling patterns. Some functions use try-catch, others use callback error parameters, many use a mix. Errors are sometimes logged to console, sometimes shown via showError(), sometimes silently swallowed. The chrome.runtime.lastError pattern is inconsistently applied.\n\n**Location:** pageInteraction.js:247-270, background.js:321-339, js/summaryHandler.js:145-161\n\n**Fix:** Create a centralized ErrorHandler class with handle(), getUserFriendlyMessage(), and trackError() methods. Standardize across all modules.","status":"open","priority":2,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:18.68089058+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:18.68089058+01:00","labels":["medium","refactor"]}
{"id":"ORS-dw7","title":"Race condition in AbortController storage for chat requests","description":"The chat abort mechanism stores the AbortController instance in chrome.storage.session. Chrome's storage API uses JSON serialization which strips object methods. The AbortController loses its abort() method when retrieved. The check 'typeof controller.abort === function' fails because the storage retrieval returns a plain object.\n\n**Location:** js/chatHandler.js:62-64 (AbortController storage), js/chatHandler.js:134-182 (abort handling)\n\n**Fix:** Use an in-memory Map for controller storage instead of session storage. Store only the requestId in session storage for abort lookup.","status":"open","priority":1,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:12.395119282+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:12.395119282+01:00","labels":["bug","high"]}
{"id":"ORS-f52","title":"XSS in Chat Message Rendering via unsanitized innerHTML","description":"The chat.js file renders assistant messages by directly assigning HTML content to innerHTML without sanitization. The renderTextAsHtml() function in utils.js uses marked.parse() but the sanitize option is deprecated and does NOT prevent XSS from LLM responses. An attacker who compromises the OpenRouter API or poisons the LLM response could inject arbitrary JavaScript that executes in the extension's chat page context, granting access to chrome.storage (containing API keys).\n\n**Location:** chat.js:504-563 (renderMessages), utils.js:121-124 (renderTextAsHtml)\n\n**Fix:** Implement DOMPurify sanitization before DOM insertion and add CSP headers to chat.html.","status":"closed","priority":0,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:21:39.395237164+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:27:47.642002658+01:00","closed_at":"2026-01-31T14:27:47.642002658+01:00","close_reason":"Fixed: Implemented DOMPurify sanitization to replace deprecated marked.parse() sanitize option, preventing XSS attacks from malicious LLM responses","labels":["critical","security"]}
{"id":"ORS-jkc","title":"XPath partial class matching in HTML sanitizer removes legitimate content","description":"The htmlSanitizer.js module uses XPath contains(@class, 'ad') which matches partial class names (e.g., 'ad' matches 'ad-banner', 'load-ad', 'loading', etc.). This overly aggressive matching removes legitimate content.\n\n**Location:** js/htmlSanitizer.js:132-148\n\n**Fix:** Replace XPath with CSS selectors using word-boundary matching [class~='classname']. This ensures exact word match, not partial string match.","status":"open","priority":2,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:46.626391634+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:46.626391634+01:00","labels":["bug","medium"]}
{"id":"ORS-ppc","title":"Hardcoded language detection model with no fallback","description":"The detectLanguage() function uses a hardcoded model ID 'moonshotai/kimi-k2' without fallback options. If this model becomes unavailable, deprecated, or the user doesn't have access to it, language detection fails silently and defaults to English.\n\n**Location:** js/summaryHandler.js:21\n\n**Fix:** Add LANGUAGE_DETECTION_MODELS array in constants.js with multiple models. Iterate through models with try-catch fallback on failure.","status":"open","priority":3,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:23:22.714874928+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:23:22.714874928+01:00","labels":["low","resilience"]}
{"id":"ORS-stb","title":"Debug logging may leak sensitive data","description":"When DEBUG mode is enabled, the code logs various objects that may contain sensitive information. API key masking is inconsistent and doesn't cover all sensitive fields. Stack traces and error objects may contain tokens.\n\n**Location:** options.js:274-281, utils.js:46-96\n\n**Fix:** Create redactSensitiveData() function that recursively masks keys containing 'apiKey', 'token', 'password', 'secret', 'auth'. Use in all DEBUG logging.","status":"open","priority":3,"issue_type":"chore","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:53.869972771+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:53.869972771+01:00","labels":["low","security"]}
{"id":"ORS-tiq","title":"No input validation on HTML content processing - DoS vector","description":"The processSelectedElement() function in pageInteraction.js processes user-selected HTML content without validating content size, nesting depth, or structure complexity. No limits on: (1) total content size (could be megabytes), (2) DOM nesting depth (could cause stack overflow), (3) number of elements. The Turndown library is called on potentially massive HTML, blocking the main thread.\n\n**Location:** pageInteraction.js:59-199 (processSelectedElement function)\n\n**Fix:** Add MAX_CONTENT_SIZE (1MB), MAX_NESTING_DEPTH (100), MAX_ELEMENT_COUNT (10000) constants and validate before processing.","status":"open","priority":1,"issue_type":"bug","owner":"bogorad@gmail","created_at":"2026-01-31T14:22:05.112874645+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:22:05.112874645+01:00","labels":["high","security"]}
{"id":"ORS-uzr","title":"Missing accessibility attributes on dynamic elements","description":"Several dynamically created elements in options.js and chat.js lack proper accessibility attributes. Autocomplete dropdown items, language flag buttons, and model selection elements should include aria-label, role, tabindex, and keyboard activation support per CONVENTIONS.md.\n\n**Location:** options.js:304-368 (autocomplete dropdown creation)\n\n**Fix:** Add role='listbox' to dropdown container, role='option' and tabindex='0' to items, aria-label attributes, and keydown handlers for Enter/Space activation.","status":"open","priority":3,"issue_type":"chore","owner":"bogorad@gmail","created_at":"2026-01-31T14:23:15.450519683+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:23:15.450519683+01:00","labels":["accessibility","low"]}
{"id":"ORS-wf9","title":"Use const instead of let for constants in background.js","description":"The background.js file uses 'let' for constants like DEFAULT_BULLET_COUNT and DEFAULT_DEBUG_MODE. These values should never be reassigned and should use 'const' per CONVENTIONS.md.\n\n**Location:** background.js:47-48\n\n**Fix:** Change 'let DEFAULT_BULLET_COUNT = \"5\"' to 'const DEFAULT_BULLET_COUNT = \"5\"' and similar for DEFAULT_DEBUG_MODE.","status":"open","priority":3,"issue_type":"chore","owner":"bogorad@gmail","created_at":"2026-01-31T14:23:01.800446712+01:00","created_by":"Eugene Bogorad","updated_at":"2026-01-31T14:23:01.800446712+01:00","labels":["code-quality","low"]}
